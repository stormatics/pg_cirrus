Welcome to pg_cirrus - Hassle-free PostgreSQL Cluster Setup


ðŸ’¡ First run detected: please enter the following details:
Ansible vault password file: All checks for VAULT_PASSWORD_FILE were passed

Subnet address for the cluster: 
Primary PostgreSQL Server IP address: 
Standby 1 IP address: 
Standby 2 IP address: 
IP address of this node to setup pgpool: 
Enter Delegate IP for Pgpool VIP: 

âœ… Configuration saved to saved_config.json 

[WARNING]: provided hosts list is empty, only localhost is available. Note that
the implicit localhost does not match 'all'

PLAY [Configure PostgreSQL primary server] *************************************

TASK [Gathering Facts] *********************************************************
ok: [localhost]

TASK [Install PostgreSQL] ******************************************************
included: /home/postgres/pg_cirrus/3-node-cluster/ansible/tasks/setup-pgdg-repo.yml for localhost

TASK [Add pgdg repo to sources (Debian/Ubuntu)] ********************************
skipping: [localhost]

TASK [Download PostgreSQL key (Debian/Ubuntu)] *********************************
skipping: [localhost]

TASK [Update apt cache (Debian/Ubuntu)] ****************************************
skipping: [localhost]

TASK [Download the PGDG RPM package] *******************************************
changed: [localhost]

TASK [Add pgdg repo to YUM (Red Hat/CentOS/Fedora)] ****************************
changed: [localhost]

TASK [Clean YUM cache (Red Hat/CentOS/Fedora)] *********************************
changed: [localhost]

TASK [Update YUM cache (Red Hat/CentOS/Fedora)] ********************************
fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["yum", "makecache"], "delta": "0:00:02.663825", "end": "2025-08-08 10:24:07.435084", "msg": "non-zero return code", "rc": -9, "start": "2025-08-08 10:24:04.771259", "stderr": "", "stderr_lines": [], "stdout": "AlmaLinux 9 - AppStream                          58 MB/s |  15 MB     00:00    ", "stdout_lines": ["AlmaLinux 9 - AppStream                          58 MB/s |  15 MB     00:00    "]}

PLAY RECAP *********************************************************************
localhost                  : ok=5    changed=3    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   

Error: Failed to execute setup-pgdg-repo.yml playbook.
Error: Failed to execute setup-pgdg-repo.yml playbook.
Traceback (most recent call last):
  File "/home/postgres/pg_cirrus/3-node-cluster/deploy.py", line 391, in <module>
    main()
  File "/home/postgres/pg_cirrus/3-node-cluster/deploy.py", line 372, in main
    PG_VERSION = GET_POSTGRESQL_VERSION()
  File "/home/postgres/pg_cirrus/3-node-cluster/deploy.py", line 163, in GET_POSTGRESQL_VERSION
    LATEST_VERSION = GET_LATEST_POSTGRESQL_MAJOR_VERSION()
  File "/home/postgres/pg_cirrus/3-node-cluster/deploy.py", line 156, in GET_LATEST_POSTGRESQL_MAJOR_VERSION
    raise ERROR
  File "/home/postgres/pg_cirrus/3-node-cluster/deploy.py", line 153, in GET_LATEST_POSTGRESQL_MAJOR_VERSION
    subprocess.run(['ansible-playbook', "--become", "ansible/playbooks/setup-pgdg-repo.yml"], check=True)
  File "/usr/lib64/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['ansible-playbook', '--become', 'ansible/playbooks/setup-pgdg-repo.yml']' returned non-zero exit status 2.
